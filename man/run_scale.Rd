% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_scale.R
\name{run_scale}
\alias{run_scale}
\title{Scale Metabolomics Data}
\usage{
run_scale(x, method = "auto", verbose = TRUE)
}
\arguments{
\item{x}{Matrix or data frame. Numeric data with samples in rows and features in columns.}

\item{method}{Character. Scaling method to apply. Options:
\itemize{
\item \code{"mean"}: Mean-centering only (centers distribution at zero)
\item \code{"auto"}: Auto-scaling (mean-centering + unit variance scaling)
\item \code{"pareto"}: Pareto-scaling (mean-centering + sqrt(SD) scaling)
}}

\item{verbose}{Logical. Print progress messages. Default: TRUE.}
}
\value{
A list of class "run_scale" containing:
\item{data}{Matrix or data frame of scaled data (same class as input \code{x})}
\item{scaling_factors}{Numeric vector of scaling factors applied to each feature}
\item{center_values}{Numeric vector of centering values (means) for each feature}
\item{method_used}{Character describing scaling method applied}
\item{parameters}{List of parameters used}
}
\description{
Applies various scaling methods to standardize features and prepare data
for multivariate analysis.
}
\details{
\strong{Scaling Methods:}
\itemize{
\item \strong{mean}: Mean-centering only. Each feature is centered to have mean = 0
but retains original variance. Useful when features are already on similar
scales and you want to preserve relative variance information.
\item \strong{auto}: Auto-scaling (also called standardization or unit variance scaling).
Each feature is mean-centered and divided by its standard deviation,
resulting in mean = 0 and SD = 1 for all features. This gives equal weight
to all features regardless of their original variance.

\strong{Recommended for:}
\itemize{
\item Principal Component Analysis (PCA)
\item Hierarchical clustering
\item Correlation analysis
\item t-tests and ANOVA
\item Most univariate and multivariate methods
}

Auto-scaling can amplify noise in low-variance features.
\item \strong{pareto}: Pareto-scaling. Each feature is mean-centered and divided by
the square root of its standard deviation. This provides a compromise between
no scaling and auto-scaling, reducing the influence of large values while
preserving some of the original variance structure.

\strong{Recommended for:}
\itemize{
\item PLS-DA (Partial Least Squares Discriminant Analysis)
\item OPLS-DA (Orthogonal PLS-DA)
\item sPLS-DA (Sparse PLS-DA)
\item Other PLS-type methods
}

Pareto-scaling is generally preferred for discriminant analysis as it
balances the importance of large and small features better than auto-scaling.
}

\strong{Choosing a Scaling Method:}

The choice depends on your downstream analysis:
\itemize{
\item For exploratory data analysis (PCA, clustering): \strong{auto-scaling}
\item For classification/discrimination (PLS-DA): \strong{Pareto-scaling}
\item When feature magnitudes carry meaning: \strong{mean-centering}
}
}
\examples{
\dontrun{
# Simulate data
set.seed(123)
x <- matrix(rnorm(100 * 50, mean = 100, sd = 50),
            nrow = 100, ncol = 50)
colnames(x) <- paste0("Feature", 1:50)

# Auto-scaling for PCA
result1 <- run_scale(x, method = "auto")

# Pareto-scaling for PLS-DA
result2 <- run_scale(x, method = "pareto")

# Mean-centering only
result3 <- run_scale(x, method = "mean")
}
}
\references{
van den Berg, R.A., Hoefsloot, H.C., Westerhuis, J.A., Smilde, A.K., & van der Werf, M.J. (2006).
Centering, scaling, and transformations: improving the biological information content of
metabolomics data. BMC Genomics, 7, 142. \doi{10.1186/1471-2164-7-142}

Becker, R.A., Chambers, J.M., & Wilks, A.R. (1988). The New S Language.
Wadsworth & Brooks/Cole. \doi{10.1201/9781351074988}
}
\author{
John Lennon L. Calorio
}
