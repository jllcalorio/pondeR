% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_filtervariance.R
\name{run_filtervariance}
\alias{run_filtervariance}
\title{Filter Features by Low Variance}
\usage{
run_filtervariance(x, percentile = 10, verbose = TRUE)
}
\arguments{
\item{x}{Matrix or data frame. Numeric data with samples in rows and features in columns.}

\item{percentile}{Numeric. Percentile threshold (0-100) for variance filtering.
Features in the bottom X percentile of variance are removed. For example,
10 removes the 10\% of features with lowest variance. Default: 10.}

\item{verbose}{Logical. Print progress messages. Default: TRUE.}
}
\value{
A list of class "run_filtervariance" containing:
\item{data}{Matrix or data frame of filtered data (same class as input \code{x})}
\item{features_removed}{Character vector of removed feature names}
\item{features_kept}{Character vector of retained feature names}
\item{variance_values}{Numeric vector of variance values for all original features}
\item{variance_threshold}{Numeric. The variance value corresponding to the percentile cutoff}
\item{n_features_before}{Integer. Number of features before filtering}
\item{n_features_after}{Integer. Number of features after filtering}
\item{n_features_removed}{Integer. Number of features removed}
\item{parameters}{List of parameters used}
}
\description{
Removes features with low variance across samples. Features with minimal
variation provide little information for downstream analysis and can be
safely removed to reduce dimensionality.
}
\details{
\strong{Why Filter by Variance:}

Features with very low variance across samples:
\itemize{
\item Provide minimal discriminatory power for classification
\item Contribute little to multivariate models (PCA, PLS-DA)
\item May represent technical noise or detection artifacts
\item Increase computational burden without adding information
}

\strong{Choosing the Percentile:}
\itemize{
\item \strong{Conservative} (5-10\%): Remove only the least variable features
\item \strong{Moderate} (10-20\%): Standard approach for most studies
\item \strong{Aggressive} (20-30\%): When high dimensionality is a concern
}

The default (10\%) removes the bottom 10\% of features by variance, which
is a commonly used threshold in metabolomics.

\strong{Important Notes:}
\enumerate{
\item Variance filtering should be applied \strong{after} normalization and
transformation, as these steps affect feature variance.
\item The variance calculation uses all samples (including QCs if present).
Consider removing QC samples before variance filtering if they have
artificially low variance.
\item For scaled data (auto or Pareto), this filter identifies features with
inherently low biological variation across the study groups.
\item Very high percentiles (>30\%) risk removing biologically relevant features
with naturally stable expression levels.
}
}
\examples{
\dontrun{
# Simulate data with varying levels of variance
set.seed(123)
n_samples <- 100
n_features <- 50

# Create features with different variance levels
x <- matrix(nrow = n_samples, ncol = n_features)
for (i in 1:n_features) {
  # Variance increases with feature index
  sd_val <- i / 2
  x[, i] <- rnorm(n_samples, mean = 100, sd = sd_val)
}
colnames(x) <- paste0("Feature", 1:n_features)

# Remove bottom 10\% (5 features with lowest variance)
result1 <- run_filtervariance(x, percentile = 10)

# More aggressive filtering (bottom 20\%)
result2 <- run_filtervariance(x, percentile = 20)
}
}
\references{
Broadhurst, D.I. (2025). QC:MXP Repeat Injection based Quality Control, Batch Correction,
Exploration & Data Cleaning (Version 2.1) Zendono. \doi{10.5281/zenodo.16824822}.
Retrieved from \url{https://github.com/broadhurstdavid/QC-MXP}.
}
\author{
John Lennon L. Calorio
}
